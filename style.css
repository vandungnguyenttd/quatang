body {
    margin: 0;
    padding: 0;
    display: flex;
    min-height: 100dvh;
    overflow: hidden;

    font-family: "Great Vibes", cursive;
    font-size: 1em;
    line-height: 1.4;

    color: hsl(180 68% 5%);
    background-color: black;
    background-image: radial-gradient(
        circle farthest-corner at 50% 50%,
        hsl(187 20% 0%) 30%,
        hsl(149 20% 0%) 100%
    );
}

#star-field {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 0;
}

/* ‚≠ê Ng√¥i sao m·∫∑c ƒë·ªãnh: tr√≤n tr·∫Øng s√°ng */
.star {
    position: absolute;
    background: white;
    border-radius: 50%;
    opacity: 0.8;
    animation: twinkle infinite;
    box-shadow: 0 0 8px white;
}

/* üåü Hi·ªáu ·ª©ng nh·∫•p nh√°y */
@keyframes twinkle1 {
    0%,
    100% {
        opacity: 0.9;
        transform: scale(1);
    }
    50% {
        opacity: 0.3;
        transform: scale(1.4);
    }
}
@keyframes twinkle2 {
    0%,
    100% {
        opacity: 0.8;
        transform: scale(1);
    }
    50% {
        opacity: 0.5;
        transform: scale(1.2);
    }
}
@keyframes twinkle3 {
    0%,
    100% {
        opacity: 1;
        transform: scale(1);
    }
    50% {
        opacity: 0.2;
        transform: scale(1.3);
    }
}
@keyframes twinkle4 {
    0%,
    100% {
        opacity: 0.7;
        transform: scale(1);
    }
    50% {
        opacity: 0.4;
        transform: scale(1.5);
    }
}
@keyframes twinkle5 {
    0%,
    100% {
        opacity: 1;
        transform: scale(1);
    }
    50% {
        opacity: 0.6;
        transform: scale(1.25);
    }
}

/* ‚≠ê Ng√¥i sao 4 c√°nh */
.star.star-4::before,
.star.star-4::after {
    content: "";
    position: absolute;
    background: white;
    opacity: 0.8;
}

.star.star-4::before {
    width: 100%;
    height: 2px;
    top: 50%;
    left: 0;
    transform: translateY(-50%);
}

.star.star-4::after {
    width: 2px;
    height: 100%;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
}

/* ‚≠ê Ng√¥i sao 5 c√°nh */
.star.star-5 {
    clip-path: polygon(
        50% 0%,
        61% 35%,
        98% 35%,
        68% 57%,
        79% 91%,
        50% 70%,
        21% 91%,
        32% 57%,
        2% 35%,
        39% 35%
    );
}

/* ‚≠ê Ng√¥i sao 6 c√°nh */
.star.star-6 {
    clip-path: polygon(
        50% 0%,
        60% 30%,
        90% 30%,
        65% 50%,
        90% 70%,
        60% 70%,
        50% 100%,
        40% 70%,
        10% 70%,
        35% 50%,
        10% 30%,
        40% 30%
    );
}

/* Giao di·ªán c·∫£nh b√°o xoay ngang */
#rotate-warning {
    position: fixed;
    inset: 0;
    z-index: 99999;
    display: none; /* JS s·∫Ω b·∫≠t khi xoay d·ªçc */
    align-items: center;
    justify-content: center;
    background: #000;
    color: #fff;
}

/* Khi kh√≥a xoay (ƒëang xoay d·ªçc) ‚Üí ·∫©n m√®o + tim bay + sao bƒÉng */
body.rotate-lock .meo-bantim,
body.rotate-lock .heart-flight,
body.rotate-lock #heart-container {
    display: none !important;
}

/* Icon ƒëi·ªán tho·∫°i */
.phone-icon {
    position: relative;
    width: 80px;
    height: 140px;
    border: 4px solid white;
    border-radius: 15px;
    box-shadow: 0 0 10px white;
    background-color: #111;
    animation: tilt 2s infinite ease-in-out;
}

.phone-body::before {
    content: "";
    position: absolute;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    width: 30px;
    height: 5px;
    background: white;
    border-radius: 3px;
}

.phone-body::after {
    content: "";
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    width: 10px;
    height: 10px;
    background: white;
    border-radius: 50%;
}

.rotate-icon {
    position: absolute;
    bottom: -50px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 2rem;
    animation: spin 2s infinite linear;
}

@keyframes spin {
    0% {
        transform: translateX(-50%) rotate(0deg);
    }
    100% {
        transform: translateX(-50%) rotate(360deg);
    }
}

@keyframes tilt {
    0%,
    100% {
        transform: rotate(0deg);
    }
    50% {
        transform: rotate(90deg);
    }
}

#shooting-canvas {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none;
    z-index: 1;
}

#heart-container {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none;
    z-index: 5;
    overflow: hidden;
}

.heart {
    position: absolute;
    left: 50%;
    bottom: 0;
    transform: translateX(-50%) translateY(0);
    font-size: 24px;
    opacity: 0.9;
    animation: flyUp 4s ease-out forwards;
    user-select: none;
    will-change: transform, opacity;
}

@keyframes flyUp {
    0% {
        transform: translateX(-50%) translateY(0);
        opacity: 1;
    }
    70% {
        transform: translateX(-50%) translateY(var(--offsetY));
        opacity: 0.9;
    }
    100% {
        transform: translateX(-50%) translateY(var(--offsetY)) scale(0.8);
        opacity: 0;
    }
}

.center-content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    z-index: 10;
}

.avatar-image {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    object-fit: cover;
    box-shadow: 0 0 12px rgba(255, 255, 255, 0.6);
    border: 3px solid white;
}

.main-title {
    margin-top: 16px;
    font-size: 1.8rem;
    color: white;
    text-shadow: 1px 1px 4px #000;
    font-family: "Segoe UI", sans-serif;
}

.start-button {
    margin-top: 16px;
    padding: 12px 24px;
    font-size: 1.1rem;
    border: none;
    border-radius: 30px;
    background: #ff69b4;
    color: white;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(255, 105, 180, 0.4);
    transition: transform 0.2s ease;
}

.start-button:hover {
    transform: scale(1.05);
}

/* M·ªù d·∫ßn to√†n b·ªô giao di·ªán */
.fade-out {
    animation: fadeOutOnly 1.5s ease forwards;
}

@keyframes fadeOutOnly {
    0% {
        opacity: 1;
    }
    100% {
        opacity: 0;
        visibility: hidden;
    }
}

/* M·ªù hi·ªán giao di·ªán m·ªõi */
.fade-in {
    animation: fadeInOnly 1.5s ease forwards;
}

@keyframes fadeInOnly {
    0% {
        opacity: 0;
    }
    100% {
        opacity: 1;
    }
}

* {
    box-sizing: border-box;
}

/* FlipBook */

#secondContent {
    position: fixed; /* full m√†n h√¨nh */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;

    display: flex;
    justify-content: center; /* cƒÉn gi·ªØa ngang */
    align-items: center; /* cƒÉn gi·ªØa d·ªçc */

    background: transparent; /* n·ªÅn trong su·ªët */
}

/* Khung bao ƒë·ªÉ cƒÉn gi·ªØa */
.book-wrapper {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100vw;
    height: 100vh;
    perspective: 1000px;
}

.book {
    position: relative;
    display: flex;
    height: 70vh; /* üîπ Chi·ªÅu cao c·ªë ƒë·ªãnh t·ªëi ƒëa */
    width: 80vh; /* T·ª± t√≠nh theo t·ª∑ l·ªá trang */
    max-height: 70vh;
    pointer-events: none;
    transform-style: preserve-3d;
    transition: translate 1s;
    translate: calc(min(var(--c), 1) * 50%) 0%;
    rotate: 1 0 0 30deg;
}
.book.snap-center {
    translate: 100% 0 !important; /* quay v·ªÅ b√™n ph·∫£i */
}

.page {
    /* PS: Don't go below thickness 0.5 or the pages might transpare */
    --thickness: 4;
    flex: none;
    display: flex;
    width: 100%;
    height: 100%;
    font-size: 2cqmin;
    /*1* allow pointer events on pages */
    pointer-events: all;
    user-select: none;
    transform-style: preserve-3d;
    transform-origin: left center;
    transition: transform 1s,
        rotate 1s ease-in
            calc((min(var(--i), var(--c)) - max(var(--i), var(--c))) * 50ms);
    translate: calc(var(--i) * -100%) 0px 0px;
    transform: translateZ(
        calc((var(--c) - var(--i) - 0.5) * calc(var(--thickness) * 0.23cqmin))
    );
    rotate: 0 1 0 calc(clamp(0, var(--c) - var(--i), 1) * -180deg);
}

.front,
.back {
    position: relative;
    flex: none;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    overflow: hidden;
    /* Fix backface visibility Firefox: */
    translate: 0px;
}

.back {
    translate: -100% 0;
    rotate: 0 1 0 180deg;
}

/* That's it. Your FlipBook customization styles: */

.book {
    counter-reset: page -1;
    & a {
        color: inherit;
    }
}

.page {
    box-shadow: 0em 0.5em 1em -0.2em #00000020;
}

.front,
.back {
    display: flex;
    flex-flow: column wrap;
    justify-content: space-between;
    padding: 2em;
    border: 1px solid #0002;

    &:has(img) {
        padding: 0;
    }

    & img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    &::after {
        position: absolute;
        bottom: 1em;
        counter-increment: page;
        content: counter(page) ".";
        font-size: 0.8em;
    }
}
.cover {
    &::after {
        content: "";
    }
}
.front {
    &::after {
        right: 1em;
    }
    background: linear-gradient(to left, #f7f7f7 80%, #eee 100%);
    border-radius: 0.1em 0.5em 0.5em 0.1em;
}
.back {
    &::after {
        left: 1em;
    }
    background-image: linear-gradient(to right, #f7f7f7 80%, #eee 100%);
    border-radius: 0.5em 0.1em 0.1em 0.5em;
}

.cover {
    background: radial-gradient(
            circle farthest-corner at 80% 20%,
            hsl(150 80% 20% / 0.3) 0%,
            hsl(170 60% 10% / 0.1) 100%
        ),
        hsl(231, 32%, 29%) url("https://picsum.photos/id/984/800/900") 50% /
            cover;
    color: hsl(200 30% 98%);
}

.front.cover {
    background: #000;
    background-image: none !important;
    padding: 0;
}

.front.cover img,
.back.cover img {
    max-height: 100%; /* Kh√¥ng v∆∞·ª£t qu√° chi·ªÅu cao c·ªßa book */
    width: auto; /* Gi·ªØ t·ªâ l·ªá ·∫£nh */
    display: block;
    margin: 0 auto; /* CƒÉn gi·ªØa ngang */
    object-fit: contain; /* ƒê·∫£m b·∫£o ·∫£nh kh√¥ng b·ªã m√©o */
    background-color: #000;
}

.back.cover.end {
    background: #000; /* n·ªÅn ƒëen */
    padding: 0;
    overflow: hidden; /* tr√°nh tr√†n ·∫£nh */
}

/* ·∫¢nh trong back cover end */
.back.cover.end > img {
    display: block;
    max-width: 100%;
    max-height: 100%;
    object-fit: contain; /* gi·ªØ t·ªâ l·ªá, kh√¥ng c·∫Øt */
    margin: 0 auto; /* cƒÉn gi·ªØa ngang */
    background: #000; /* n·ªÅn ƒëen n·∫øu ·∫£nh nh·ªè */
}

#nextButton {
    opacity: 0; /* ban ƒë·∫ßu ·∫©n */
    pointer-events: none; /* kh√¥ng click khi ·∫©n */
    position: absolute;
    bottom: 10px;
    right: 20px;
    padding: 10px 10px;
    font-size: 3.5rem;
    background-color: rgba(255, 105, 180, 0.0);
    color: white;
    border: none;
    border-radius: 20px;
    cursor: pointer;
    z-index: 30;
    transition: opacity 1s ease; /* hi·ªáu ·ª©ng m·ªù d·∫ßn */
}

#nextButton.visible {
    opacity: 1; /* hi·ªán r√µ */
    pointer-events: auto; /* cho click */
}

#nextButton:hover {
    transform: scale(1.05);
}

/* Giao di·ªán 3 full m√†n, cƒÉn gi·ªØa n·∫øu c·∫ßn */
#thirdContent {
    position: fixed;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    z-index: 20;
    overflow: visible;
}

/* L·ªõp m∆∞a ch·ªØ */
.content-rain {
    position: absolute;
    inset: 0;
    pointer-events: none;
    overflow: visible; /* cho ph√©p tr√†n c·∫£ tr√°i/ph·∫£i & d∆∞·ªõi */
    z-index: 25;
}

.rain-item {
    position: absolute;
    top: -10vh;
    left: 0;
    transform: translateX(-50%);
    font-family: "Segoe UI", system-ui, Arial, sans-serif;
    font-weight: 700;
    font-size: clamp(16px, 2.2vw, 28px);
    color: #fff;
    opacity: 0.95;
    animation: drop var(--dur, 3s) linear forwards;
    pointer-events: none;
    color: #ff66b2;
}

.rain-item .label,
.rain-item .ghost {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    white-space: nowrap;
}

.rain-item .label {
    font-family: "Great Vibes", cursive;
    color: #ff66b2;
    font-weight: bold;
    opacity: var(--itemAlpha, 1);
}

.rain-item .ghost {
    -webkit-text-stroke: 0 transparent;
    text-shadow: none;
    opacity: var(--alpha, 0.3);
}

/* R∆°i t·ªõi v·ªã tr√≠ do JS ƒë·∫∑t trong --endY (40‚Äì100vh) */
@keyframes drop {
    0% {
        transform: translate(-50%, -40vh);
        opacity: 0;
    }
    8% {
        opacity: 1;
    }
    100% {
        transform: translate(-50%, var(--endY, 110vh));
        opacity: 1;
    }
}

.media-rain {
    position: absolute;
    inset: 0;
    pointer-events: none;
    overflow: visible; /* tr√†n tr√°i/ph·∫£i & d∆∞·ªõi */
    z-index: 26; /* tr√™n m∆∞a ch·ªØ m·ªôt l·ªõp */
}

/* Item chung */
.rain-media {
    position: absolute;
    top: -10vh;
    left: 0;
    transform: translateX(-50%);
    animation: drop var(--dur, 3s) linear forwards; /* gi·ªØ tr·∫°ng th√°i cu·ªëi */
    filter: drop-shadow(0 6px 16px rgba(0, 0, 0, 0.45));
    opacity: 0.98;
}

.rain-media img,
.rain-media video {
    display: block;
    width: calc(var(--w, 120px) * 0.7); /* gi·∫£m 30% */
    height: calc(var(--h, 160px) * 0.7); /* gi·∫£m 30% */
    object-fit: cover;
    border-radius: 10px;
}

.rain-media > .rain-media,
.rain-media > span.rain-media {
    top: 0; /* g·ªëc theo top 0, ƒë·ªÉ keyframes ƒëi·ªÅu khi·ªÉn to√†n b·ªô */
    left: 0;
    transform: translateX(-50%);
}

/* Trang front hi·ªÉn th·ªã full, b·ªè padding ƒë·ªÉ ·∫£nh tr√†n khung ƒë·∫πp */
.front {
    padding: 0 !important;
    overflow: hidden;
}

.back {
    position: relative; /* L√†m m·ªëc cho caption */
    height: 100%; /* Full chi·ªÅu cao c·ªßa book page */
}

.back .video-caption {
    position: absolute;
    bottom: 0; /* D√≠nh xu·ªëng ƒë√°y ·∫£nh */
    left: 0;
    width: 100%;
    padding: 8px;
    background: rgba(0, 0, 0, 0.4); /* N·ªÅn m·ªù ƒë·ªÉ ch·ªØ d·ªÖ ƒë·ªçc */
    color: white;
    font-size: 1rem;
    text-align: center;
    box-sizing: border-box;
}

.front .image-caption {
    position: absolute;
    bottom: 0; /* D√≠nh ƒë√°y ·∫£nh */
    left: 0;
    width: 100%;
    padding: 8px;
    font-size: 1rem;
    color: white;
    background: rgba(0, 0, 0, 0.4); /* N·ªÅn m·ªù ƒë·ªÉ ch·ªØ n·ªïi b·∫≠t */
    text-align: center;
    box-sizing: border-box;
}

.meo-bantim {
    position: fixed;
    bottom: 20px;
    left: 20px;
    width: 120px;
    height: auto;
    z-index: 9999;
    pointer-events: none;
}

/* Tim bay theo h∆∞·ªõng (t·ª± di chuy·ªÉn b·∫±ng JS, kh√¥ng d√πng keyframes c≈©) */
.heart-flight {
    position: fixed;
    left: 0;
    top: 0; /* JS s·∫Ω set to·∫° ƒë·ªô */
    transform: translate(-50%, -50%);
    font-size: 28px; /* JS c√≥ th·ªÉ random */
    pointer-events: none;
    z-index: 9999;
    will-change: transform, opacity;
}

/* C·∫≠p nh·∫≠t 12/8
/* --- START - ·∫£nh /video trong book --- */
.book .front img,
.book .back img {
    width: 100%;
    height: 100%;
    object-fit: contain !important; /* hi·ªÉn th·ªã to√†n b·ªô ·∫£nh, kh√¥ng crop */
    display: block;
    border-radius: 0 !important; /* kh√¥ng bo tr√≤n g√≥c ·∫£nh */
}

/* N·∫øu khung c√≥ padding, vi·ªÅn‚Ä¶ mu·ªën ·∫£nh s√°t khung th√¨ b·ªè padding: */
.book .front,
.book .back {
    padding: 0; /* tu·ª≥ √Ω: n·∫øu b·∫°n v·∫´n c·∫ßn caption, gi·ªØ padding */
    overflow: hidden; /* tr√°nh tr√†n vi·ªÅn khi t·ªâ l·ªá kh√°c nhau */
    background-color: #fff; /* ‚Äúletterbox‚Äù m√†u tr·∫Øng xung quanh ·∫£nh */
}

.book .front video,
.book .back video {
    width: 100%;
    height: 100%;
    object-fit: contain !important; /* Gi·ªØ nguy√™n t·ª∑ l·ªá, kh√¥ng m·∫•t g√≥c */
    display: block;
    border-radius: 0 !important;
    background-color: #000; /* tu·ª≥ b·∫°n mu·ªën n·ªÅn g√¨ khi c√≥ vi·ªÅn tr·ªëng */
}

.book .front,
.book .back {
    padding: 0;
    overflow: hidden;
}
/* --- END - CSS ·∫£nh /video trong book --- */

/* --- START - V√πng nh·∫•p xem ·∫£nh --- */
.book .front .hotspot,
.book .back .hotspot {
    position: absolute;
    background: rgba(0, 0, 0, 0.7); /* n·ªÅn tr·∫Øng 50% nh∆∞ y√™u c·∫ßu */
    border: 0; /* kh√¥ng vi·ªÅn */
    cursor: pointer;
    z-index: 12;
}

/* --- Lightbox hi·ªÉn th·ªã ·∫£nh popup --- */
#asset-lightbox {
    position: fixed;
    inset: 0;
    display: none;
    align-items: center;
    justify-content: center;
    background: rgba(0, 0, 0, 0.7);
    z-index: 2147483645;
}
#asset-lightbox.open {
    display: flex;
}
#asset-lightbox img {
    max-width: min(92vw, 1200px);
    max-height: 92vh;
    object-fit: contain;
    display: block;

    opacity: 0;
    transition: opacity 1000ms ease; /* m∆∞·ª£t 0.3s */
    will-change: opacity;
}
#asset-lightbox img.show {
    opacity: 1;
} /* m·ªü: hi·ªán d·∫ßn */
#asset-lightbox.closing img {
    opacity: 0;
} /* ƒë√≥ng: m·ªù d·∫ßn */

@media (prefers-reduced-motion: reduce) {
    #asset-lightbox img {
        transition: none !important;
    }
}
#asset-lightbox .close {
    position: absolute;
    top: 12px;
    right: 16px;
    font: 600 18px/1 system-ui, sans-serif;
    color: #fff;
    background: transparent;
    border: none;
    cursor: pointer;
}
/* --- END - V√πng nh·∫•p xem ·∫£nh --- */

/* --- START - N√∫t BACK --- */
/* Back gi·ªëng Next nh∆∞ng ·ªü g√≥c tr√°i, m·∫∑c ƒë·ªãnh ·∫©n */
#backButton {
    opacity: 0;
    pointer-events: none;
    position: absolute;
    bottom: 20px;
    left: 20px;
    padding: 10px 20px;
    font-size: 1rem;
    background-color: #ff69b4;
    color: #fff;
    border: none;
    border-radius: 20px;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(255, 105, 180, 0.4);
    z-index: 30;
    transition: opacity 1s ease, transform 0.2s ease;
}
#backButton.visible {
    opacity: 1;
    pointer-events: auto;
}
#backButton:hover {
    transform: scale(1.05);
}
/* --- END - N√∫t BACK --- */

/* --- START - N·ªòI DUNG --- */
.lightbox-figure { position: relative; margin: 0; }
.lightbox-figure > img {
  display:block;
  max-width:min(92vw,1200px);
  max-height:92vh;
  object-fit:contain;
}
.lightbox-figure > img.rounded {
  border-radius: 16px;          /* ƒë·ªïi 16px tu·ª≥ √Ω */
  overflow: hidden;             /* ƒë·ªÉ caption b√°m vi·ªÅn g·ªçn */
}
.lightbox-caption {
  position: absolute;
  top: 10%;             /* c√°ch ƒë·ªânh ·∫£nh 10% */
  left: 0;
  max-width: 70%;
  padding: 8px 12px;
  font: 500 14px/1.4 system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  color: #000000;
  text-align: left;
  background: rgba(0,0,0,0.0);
  backdrop-filter: blur(2px);
  border-bottom-right-radius: 6px;
  opacity: 0;
  transform: translateY(-4px);
  transition: opacity .25s ease, transform .25s ease;
  pointer-events: none;
}
#asset-lightbox.open .lightbox-caption.has-text {
  opacity: 1;
  transform: translateY(0);
}
/* --- END - N·ªòI DUNG --- */

